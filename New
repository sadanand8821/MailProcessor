Sub FillMissingSerials()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long, expectedValue As Long
    
    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets("payments_cleaned") ' Change to your sheet name
    
    ' Find the last row in the Serial column
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Loop through rows to check for missing serials
    expectedValue = 1
    For i = 2 To lastRow
        If ws.Cells(i, 1).Value <> expectedValue Then
            ' Insert a row
            ws.Rows(i).Insert
            ws.Cells(i, 1).Value = expectedValue
        End If
        expectedValue = expectedValue + 1
    Next i
End Sub
